{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"HACKING AWESOME CHEATSHEET","text":""},{"location":"enumeration/enumeration/","title":"Enumeration","text":""},{"location":"enumeration/enumeration/#host-discovery","title":"Host discovery","text":"<p>Powershell</p> <pre><code>1..254 | % { $ip=\"172.30.0.$_\"; if (ping -n 1 -w 100 $ip | Select-String \"TTL=\") { \"$ip is up\" } }\n</code></pre> <p>Bash</p> <pre><code>for ip in 172.30.0.{1..254}; do ping -c 1 -W 1 $ip &gt;/dev/null 2&gt;&amp;1 &amp;&amp; echo \"$ip is up\"; done\n</code></pre>"},{"location":"enumeration/enumeration/#rustscan","title":"Rustscan","text":"<pre><code>sudo apt install cargo\ncargo install rustscan\nexport PATH=$PATH:/path/to/rustscan\nchmod +x /path/to/rustscan\necho 'export PATH=$PATH:/root/.cargo/bin' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nrustscan --version\nrustscan -a 172.20.0.52 -r 1-1000 //r - port range\nrustscan -a 172.20.0.52 -r 1-1000 -u -- -Pn //no ping\n\n</code></pre>"},{"location":"enumeration/nmap/","title":"Nmap","text":"<ol> <li>Host discovery: <code>sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d\" \" -f5</code></li> <li>Scanning from IP list file: <code>sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d\" \" -f5</code></li> <li>Scan Multiple IPs: <code>sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 10.129.2.20| grep for | cut -d\" \" -f5</code></li> <li>Scan Single IP: <code>sudo nmap 10.129.2.18 -sn -oA host</code></li> <li>Discovering Open UDP Ports: <code>sudo nmap 10.129.2.28 -F -sU</code></li> <li>Banner Grabbing: <code>sudo nmap 10.129.2.28 -p- -sV</code></li> <li>Specifying Scripts: <code>sudo nmap 10.129.2.28 -p 25 --script banner,smtp-commands</code></li> <li>Vuln Category: <code>sudo nmap 10.129.2.28 -p 80 -sV --script vuln</code></li> <li>Optimized RTT: <code>sudo nmap 10.129.2.0/24 -F --initial-rtt-timeout 50ms --max-rtt-timeout 100ms</code></li> <li>Decoy: <code>sudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5</code></li> </ol>"},{"location":"footprinting/dns/","title":"DNS","text":"<ol> <li>DIG<ol> <li>NS Query <code>dig ns inlanefreight.htb @10.129.14.128</code></li> <li>Version Query <code>dig CH TXT version.bind 10.129.120.85</code></li> <li>ANY Query <code>dig any inlanefreight.htb @10.129.14.128</code></li> <li>DIG - AXFR Zone Transfer <code>dig axfr inlanefreight.htb @10.129.14.128</code></li> <li>DIG - AXFR Zone Transfer - Internal <code>dig axfr internal.inlanefreight.htb @10.129.14.128</code></li> </ol> </li> <li>Subdomain Brute Forcing <code>for sub in $(cat /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt);do dig $sub.inlanefreight.htb @10.129.14.128 | grep -v ';\\|SOA' | sed -r '/^\\s*$/d' | grep $sub | tee -a subdomains.txt;done</code></li> <li>DNSenum <code>dnsenum --dnsserver 10.129.14.128 --enum -p 0 -s 0 -o subdomains.txt -f /opt/useful/SecLists/Discovery/DNS/subdomains-top1million-110000.txt inlanefreight.htb</code></li> </ol>"},{"location":"footprinting/domain-info/","title":"Domain info","text":"<ol> <li>Certificate Transparency: <code>curl -s https://crt.sh/\\?q\\=inlanefreight.com\\&amp;output\\=json | jq .</code></li> <li>Filtered by the unique subdomains: <code>curl -s https://crt.sh/\\?q\\=inlanefreight.com\\&amp;output\\=json | jq . | grep</code></li> <li>Identify the hosts directly accessible from the Internet and not hosted by third-party providers: <code>for i in $(cat subdomainlist);do host $i | grep \"has address\" | grep inlanefreight.com | cut -d\" \" -f1,4;done</code></li> <li>Shodan: <ol> <li><code>for i in $(cat subdomainlist);do host $i | grep \"has address\" | grep inlanefreight.com | cut -d\" \" -f4 &gt;&gt; ip-addresses.txt;done</code></li> <li><code>for i in $(cat ip-addresses.txt);do shodan host $i;done</code></li> </ol> </li> <li>Display all the available DNS records where we might find more hosts: <code>dig any inlanefreight.com</code></li> </ol>"},{"location":"footprinting/domain-info/#cloud-resources","title":"Cloud Resources","text":"<ol> <li>Company Hosted Servers: <code>for i in $(cat subdomainlist);do host $i | grep \"has address\" | grep inlanefreight.com | cut -d\" \" -f1,4;done</code></li> <li>Google Search for AWS: <code>intext:sometexthere inurl:amazonaws.com</code></li> <li>Google Search for Azure: <code>intext:sometexthere inurl:blob.core.windows.net</code></li> </ol>"},{"location":"footprinting/ftp/","title":"FTP","text":"<ol> <li>Anonymous Login: <code>ftp 10.129.14.136</code> </li> <li>Download file: <code>get filename</code></li> <li>Download All Available Files: <code>wget -m --no-passive ftp://anonymous:anonymous@10.129.14.136</code></li> <li>Upload a File: <code>put testupload.txt</code></li> <li>Nmap:<ol> <li><code>find / -type f -name ftp* 2&gt;/dev/null | grep scripts</code></li> <li><code>sudo nmap -sV -p21 -sC -A 10.129.14.136</code> <code>\u2014scripts \u2014script-trace</code></li> </ol> </li> </ol>"},{"location":"footprinting/imap-pop3/","title":"IMAP/POP3","text":"<ol> <li>Nmap: <code>sudo nmap 10.129.14.128 -sV -p110,143,993,995 -sC</code></li> <li>cURL: <code>curl -k 'imaps://10.129.14.128' --user user:p4ssw0rd</code> <code>-v</code></li> <li>OpenSSL - TLS Encrypted Interaction POP3: <code>openssl s_client -connect 10.129.14.128:pop3s</code></li> <li>OpenSSL - TLS Encrypted Interaction IMAP: <code>openssl s_client -connect 10.129.14.128:imaps</code></li> <li>IMAP Commands</li> </ol> <pre><code>1 LOGIN username password #User's login.\n1 LIST \"\" * #Lists all directories.  \n1 CREATE \"INBOX\" #Creates a mailbox with a specified name.                                  \n1 DELETE \"INBOX\" #Deletes a mailbox.      \n1 RENAME \"ToRead\" \"Important\" #Renames a mailbox. \n1 LSUB \"\" * #Returns a subset of names from the set of names that the User has declared as being active or subscribed. |\n1 SELECT INBOX #Selects a mailbox so that messages in the mailbox can be accessed.        \n1 UNSELECT INBOX #Exits the selected mailbox.                             \n1 FETCH &lt;ID&gt; all #Retrieves data associated with a message in the mailbox.                  \n1 CLOSE #Removes all messages with the Deleted flag set.                           \n1 LOGOUT #Closes the connection with the IMAP server.                               \n</code></pre> <ol> <li>POP3 Commands</li> </ol> <pre><code>USER #usernameIdentifies the user.                        \nPASS #passwordAuthentication of the user using its password.            \nSTAT #Requests the number of saved emails from the server.      \nLIST #Requests from the server the number and size of all emails.             |\nRETR id #Requests the server to deliver the requested email by ID. \nDELE id #Requests the server to delete the requested email by ID.   \nCAPA #Requests the server to display the server capabilities.   \nRSET #Requests the server to reset the transmitted information. \nQUIT #Closes the connection with the POP3 server. \n</code></pre>"},{"location":"footprinting/ipmi/","title":"IPMI","text":"<ol> <li>Nmap: <code>sudo nmap -sU --script ipmi-version -p 623 ilo.inlanfreight.local</code></li> <li>Metasploit Version Scan: <code>msf6 &gt; use auxiliary/scanner/ipmi/ipmi_version</code></li> <li>Metasploit dump hashes: <code>msf6 &gt; use auxiliary/scanner/ipmi/ipmi_dumphashes</code></li> </ol>"},{"location":"footprinting/ldap/","title":"LDAP","text":"<ol> <li>LDAP Anonymous Bind<ol> <li>Confirmation that anonymous bind can be done with Python:</li> </ol> </li> </ol> <pre><code>from ldap3 import*\ns = Server('10.10.10.161',get_info = ALL)\nc = Connection(s,'','')\nc.bind()\nTrue\n</code></pre> <ol> <li>We can confirm anonymous LDAP bind with <code>ldapsearch</code> and retrieve all AD objects from LDA: <code>ldapsearch -H ldap://10.129.1.207 -x -b \"dc=inlanefreight,dc=local\"</code></li> <li>Windapsearch<ol> <li><code>python3 [windapsearch.py](http://windapsearch.py/) --dc-ip 10.10.10.161 -u \"\" -U</code></li> <li><code>python3 [windapsearch.py](http://windapsearch.py/) --dc-ip 10.10.10.161 -d htb.local --custom \"objectClass=*\"</code></li> </ol> </li> </ol>"},{"location":"footprinting/mongodb/","title":"MongoDB","text":"<ol> <li><code>mongo ip-address:port</code></li> <li><code>show dbs</code></li> <li><code>use db-name</code></li> <li><code>show collections</code></li> <li>Show content of collection: <code>db.flag.find().pretty()</code></li> </ol>"},{"location":"footprinting/mssql/","title":"MSSQL","text":"<ol> <li>Nmap: <code>sudo nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 10.129.201.248</code></li> <li>MSSQL Ping in Metasploit: <code>msf6 auxiliary(scanner/mssql/mssql_ping) &gt; set rhosts 10.129.201.248</code></li> <li>Connecting with Mssqlclient.py<ol> <li>connect <code>python3 mssqlclient.py Administrator@10.129.201.248 -windows-auth</code></li> <li>Interact with: <code>select name from sys.databases</code></li> </ol> </li> </ol>"},{"location":"footprinting/mysql/","title":"MYSQL","text":"<ol> <li>Nmap: <code>sudo nmap 10.129.14.128 -sV -sC -p3306 --script mysql*</code></li> <li>Interaction with MySQL:<ol> <li>without pass: <code>mysql -u root -h 10.129.14.132</code></li> <li>with pass: <code>mysql -u root -pP4SSw0rd -h 10.129.14.128</code></li> </ol> </li> <li>Commands:</li> </ol> <pre><code>show databases;\nselect version();\nuse mysql;\nshow tables;\nshow columns from &lt;table&gt;;\nselect * from &lt;table&gt;;\nselect * from &lt;table&gt; where &lt;column&gt; = \"&lt;string&gt;\";\n</code></pre>"},{"location":"footprinting/nfs/","title":"NFS","text":"<ol> <li>Nmap:<ol> <li><code>sudo nmap 10.129.14.128 -p111,2049 -sV -sC</code></li> <li><code>sudo nmap --script nfs* 10.129.14.128 -sV -p111,2049</code></li> </ol> </li> <li>Show Available NFS Shares: <code>showmount -e 10.129.14.128</code></li> <li>Mounting NFS Share:</li> </ol> <pre><code>mkdir target-NFS\nsudo mount -t nfs 10.129.14.128:/ ./target-NFS/ -o nolock\ncd target-NFS\ntree .\n</code></pre> <ol> <li>List Contents with Usernames &amp; Group Names: <code>ls -l mnt/nfs/</code></li> <li>List Contents with UIDs &amp; GUIDs: <code>ls -n mnt/nfs/</code></li> <li>Unmounting:<ol> <li><code>cd ..</code></li> <li><code>sudo umount ./target-NFS</code></li> </ol> </li> </ol>"},{"location":"footprinting/rdp/","title":"RDP","text":"<ol> <li>Nmap: <code>nmap -sV -sC 10.129.201.248 -p3389 --script rdp*</code></li> <li>rdp-sec-check<ol> <li><code>git clone https://github.com/CiscoCXSecurity/rdp-sec-check.git &amp;&amp; cd rdp-sec-check</code></li> <li><code>./rdp-sec-check.pl 10.129.201.24</code> </li> </ol> </li> <li>Initiate an RDP Session<ol> <li><code>xfreerdp /u:cry0l1t3 /p:\"P455w0rd!\" /v:10.129.201.248</code></li> <li><code>xfreerdp /u:username /p:password /v:10.129.75.180 /cert-ignore /bpp:8 /network:modem /compression -themes -wallpaper /clipboard /audio-mode:1 /auto-reconnect -glyph-cache /dynamic-resolution /drive:linux,/</code></li> </ol> </li> </ol>"},{"location":"footprinting/rservices/","title":"RSERVICES","text":"<ol> <li>Nmap: <code>sudo nmap -sV -p 512,513,514 10.0.17.2</code></li> <li>Logging in Using Rlogin: <code>rlogin 10.0.17.2 -l user-name</code></li> </ol>"},{"location":"footprinting/rsync/","title":"RSYNC","text":"<ol> <li>Nmap: <code>sudo nmap -sV -p 873 127.0.0.1</code></li> <li>Enumerating an Open Share: <code>rsync -av --list-only rsync://127.0.0.1/dev</code></li> </ol>"},{"location":"footprinting/smb/","title":"SMB","text":"<ol> <li>Nmap: <code>sudo nmap 10.129.14.128 -sV -sC -p139,445</code></li> <li> <p>SMBclient     <code>bash     smbclient -N -L //10.129.14.128 # no logon     smbclient //10.129.14.128/notes # connecting to share</code></p> </li> <li> <p>Download Files: <code>get file_name</code></p> </li> <li>Brute Forcing User RIDs: <ol> <li> <p><code>bash for i in $(seq 500 1100);do rpcclient -N -U \"\" 10.129.14.128 -c \"queryuser 0x$(printf '%x\\n' $i)\" | grep \"User Name\\|user_rid\\|group_rid\" &amp;&amp; echo \"\";done</code></p> </li> <li>You can use script from Impacket called samrdump.py alternatively: <code>samrdump.py 10.129.14.128</code></li> </ol> </li> <li>Crackmapexec: <code>crackmapexec smb 10.129.14.128 --shares -u '' -p ''</code></li> <li>RPCclient:</li> </ol> <pre><code>rpcclient -U \"\" 10.129.14.128\nsrvinfo\nenumdomains\nquerydominfo\nnetshareenumall\nnetsharegetinfo notes\nenumdomusers\nqueryuser 0x3e9\nquerygroup 0x201\n</code></pre> <ol> <li>SMBMap: <code>smbmap -H 10.129.14.128</code></li> <li>Enum4Linux:</li> </ol> <pre><code>git clone https://github.com/cddmp/enum4linux-ng.git\ncd enum4linux-ng\npip3 install -r requirements.txt\n./enum4linux-ng.py 10.129.14.128 -A\n</code></pre> <ol> <li>HYDRA <code>hydra -L user.list -P password.list smb://10.129.42.197</code></li> </ol>"},{"location":"footprinting/smtp/","title":"SMTP","text":"<ol> <li>Nmap<ol> <li><code>sudo nmap 10.129.14.128 -sC -sV -p25</code></li> <li><code>sudo nmap 10.129.14.128 -p25 --script smtp-open-relay -v</code></li> </ol> </li> <li>Commands</li> </ol> <pre><code>AUTH PLAIN AUTH #is a service extension used to authenticate the client.                                   |\nHELO #The client logs in with its computer name and thus starts the session.                         |\nMAIL FROM #The client names the email sender.                                                             |\nRCPT TO #The client names the email recipient.                                                          |\nDATA #The client initiates the transmission of the email.                                            |\nRSET #The client aborts the initiated transmission but keeps the connection between client and server.|\nVRFY #The client checks if a mailbox is available for message transfer.                              |\nEXPN #The client also checks if a mailbox is available for messaging with this command.              |\nNOOP #The client requests a response from the server to prevent disconnection due to time-out.       |\nQUIT #The client terminates the session. \n</code></pre>"},{"location":"footprinting/snmp/","title":"SNMP","text":"<ol> <li>SNMPwalk: <code>snmpwalk -v2c -c public 10.129.14.128</code></li> <li>OneSixtyOne: <ol> <li><code>sudo apt install onesixtyone</code></li> <li><code>onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp.txt 10.129.14.128</code></li> </ol> </li> <li>Braa:<ol> <li><code>sudo apt install braa</code></li> <li><code>braa &lt;community string&gt;@&lt;IP&gt;:.1.3.6.*   # Syntax</code></li> <li><code>braa public@10.129.14.128:.1.3.6.* # example</code></li> </ol> </li> </ol>"},{"location":"footprinting/ssh/","title":"SSH","text":"<ol> <li>SSH audit<ol> <li><code>git clone https://github.com/jtesta/ssh-audit.git &amp;&amp; cd ssh-audit</code></li> <li><code>./ssh-audit.py 10.129.14.132</code></li> </ol> </li> </ol>"},{"location":"footprinting/tns/","title":"ORACLE TNS","text":"<ol> <li>Nmap<ol> <li><code>sudo nmap -p1521 -sV 10.129.204.235 --open</code></li> <li><code>sudo nmap -p1521 -sV 10.129.204.235 --open --script oracle-sid-brute</code></li> </ol> </li> <li>odat.py <code>./odat.py all -s 10.129.204.235</code></li> <li>SQLplus - for log In: <code>sqlplus scott/tiger@10.129.204.235/XE</code></li> <li>SQLplus commands</li> </ol>"},{"location":"footprinting/winrm/","title":"WinRM","text":"<ol> <li>Nmap: <code>nmap -sV -sC 10.129.201.248 -p5985,5986 --disable-arp-ping -n</code></li> </ol>"},{"location":"footprinting/wmi/","title":"Wmi","text":"<ol> <li>wmiexec.py <code>usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:\"P455w0rD!\"@10.129.201.248 \"hostname\"</code></li> </ol>"}]}